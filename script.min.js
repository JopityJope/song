const searchBtn=document.querySelector(".search_btn"),searchEl=document.querySelector(".search"),input=document.querySelector(".search_input"),background=document.querySelector(".search_section"),songList=document.querySelector(".song_list"),songSection=document.querySelector(".song"),loader=document.querySelector(".loader"),message=document.querySelector(".message"),searchIcon=document.querySelector(".search_icon");async function loadSongs(e){try{let s=`https://itunes.apple.com/search?term=${e}&entity=song`,n=await fetch(s),t=await n.json();0===t.resultCount?(songList.innerHTML="",showNoResultsMessage(input.value)):displaySongList(t.results)}catch{loader.classList.remove("loader--active"),songList.innerHTML="",showErrorMessage()}}function findSongs(){let e=input.value.trim();e.length>0?(songList.classList.remove("song_list--hide"),loader.classList.remove("loader--active"),loadSongs(e)):songList.classList.add("song_list--hide")}function displaySongList(e){songList.innerHTML="",message.innerHTML="",e.forEach((e,s)=>{if(s<5){let n=document.createElement("li");n.classList.add("song_item"),n.innerHTML=`<span class="bold">${e.trackName}</span> - <span >${e.artistName}</span>`,songList.appendChild(n)}})}function showNoResultsMessage(e){message.innerHTML=`Nema rezultata za pojam <span class="message_input">"${e}"</span>`}function showErrorMessage(){message.innerHTML="Greška. Pokušaj ponovno."}function clearMessage(){message.innerHTML=""}input.value="",background.addEventListener("click",function(e){e.target.classList.contains("search_section")&&0===input.value.length&&(searchIcon.innerHTML='<use xlink:href="img/sprite.svg#icon-search"></use>',searchEl.classList.remove("search--active"),searchBtn.classList.remove("search_btn--remove"))}),window.addEventListener("keydown",function(e){"Escape"===e.key&&0===input.value.trim().length?(searchEl.classList.remove("search--active"),searchBtn.classList.remove("search_btn--remove"),searchIcon.innerHTML='<use xlink:href="img/sprite.svg#icon-search"></use>'):"Escape"===e.key&&(input.value="",songList.innerHTML="",clearMessage(),searchBtn.classList.add("search_btn--remove"))}),searchBtn.addEventListener("click",function(){if(0===input.value.trim().length){searchEl.classList.toggle("search--active"),searchBtn.classList.add("search_btn--remove");let e=function(){input.focus()};setTimeout(e,1200)}else 0!==input.value.trim().length&&(input.value="",songList.innerHTML="",clearMessage(),searchBtn.classList.add("search_btn--remove"))}),input.addEventListener("keyup",function(){loader.classList.add("loader--active"),clearMessage(),findSongs(),0===input.value.trim().length?(loader.classList.remove("loader--active"),songList.innerHTML="",searchBtn.classList.add("search_btn--remove")):0!==input.value.trim().length&&(searchIcon.innerHTML='<use xlink:href="img/sprite.svg#icon-close"></use>',searchBtn.classList.remove("search_btn--remove"))});
